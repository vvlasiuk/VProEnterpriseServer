version: "1.0.0"

tables:
  cat_external_data_mapping:
    description: "External ID mapping"
    columns:
      _id:
        type: "BIGINT"
        primary_key: true
        auto_increment: true
        nullable: false
      
      # Джерело даних
      source_id:
        type: "BIGINT"
        nullable: false
        foreign_key: "cat_external_data_sources.id"
        comment: "Джерело даних"
      
      # Зовнішній ідентифікатор
      external_id:
        type: "NVARCHAR(50)"
        nullable: false
        comment: "Зовнішній ID/артикул/код"
      
      # Внутрішній ідентифікатор
      internal_id:
        type: "BIGINT"
        nullable: false
        comment: "ID запису в нашій БД"
      
      # Тип даних
      internal_type_id:
        type: "BIGINT"
        nullable: false
        foreign_key: "sys_data_types.id"
        comment: "Тип даних"
      
      # Дата створення
      _created_at:
        type: "DATETIME2"
        default: "GETDATE()"
        comment: "Дата створення зв'язку"
    indexes:
      - name: "IX_external_mapping_unique"
        columns: ["source_id", "internal_type_id", "external_id"]  # ← Виправити тут
        unique: true
      - name: "IX_external_mapping_internal"
        columns: ["internal_id"]