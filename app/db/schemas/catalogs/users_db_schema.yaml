# Основні таблиці системи
version: "1.0.0"
description: "Users"

tables:
  # Користувачі системи
  users:
    parent: "catalog"
    columns:
      full_name:
        type: "NVARCHAR(50)"
        nullable: false
        unique: true
        comment: "Повне ім'я користувача"
      email:
        type: "NVARCHAR(100)"
        nullable: false
        unique: true
        comment: "Email адреса"
      password_hash:
        type: "NVARCHAR(255)"
        nullable: false
        comment: "Хеш пароля"
      phone:
        type: "NVARCHAR(20)"
        nullable: true
        comment: "Телефон"
      last_login:
        type: "DATETIME2"
        nullable: true
        comment: "Останній вхід"
      is_admin:
        type: "BIT"
        default: 0
        comment: "Адміністратор"
      is_active:
        type: "BIT"
        nullable: false
        default: 1
        comment: "Активний користувач"
    indexes:
      - name: "IX_users_full_name"
        columns: ["full_name"]
        unique: true

  # Зв'язок користувачів і ролей
  user_roles:
    columns:
      id:
        type: "BIGINT"
        primary_key: true
        auto_increment: true
      user_id:
        type: "BIGINT"
        nullable: false
        foreign_key: "users.id"
        comment: "Користувач"
      role_id:
        type: "BIGINT"
        nullable: false
        foreign_key: "roles.id"
        comment: "Роль"
      assigned_at:
        type: "DATETIME2"
        default: "GETDATE()"
        comment: "Дата призначення"
      assigned_by:
        type: "BIGINT"
        nullable: false
        foreign_key: "users.id"
        comment: "Хто призначив"
    indexes:
      - name: "IX_user_roles_user_role"
        columns: ["user_id", "role_id"]
        unique: true
